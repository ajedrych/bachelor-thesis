setwd("D:/BACHELOR THESIS")
library("readxl")
library("lmtest")
library("sandwich")
library("knitr")
#wczytuje dane
waga <- read_excel("wypadki+meteo.xlsx")
View(waga)
#usuwam puste obserwacje
waga1<-na.omit(waga)
str(waga1) #jakie zmienne mają typy
library("tidyverse")
g_wzrost<-ggplot(waga1, aes(x=Wypadki, y=avg_temp)) +geom_point(color="blue")
g_wzrost
g_wzrost<-ggplot(waga1, aes(x=wypadki, y=avg_temp)) +geom_point(color="blue")
g_wzrost
g_wzrost<-ggplot(waga1, aes(x=wypadki, y=I(log(avg_temp)) +geom_point(color="blue")
g_wiek<-ggplot(waga2, aes(x=Waga, y=Wiek)) +geom_point(color="blue")
g_wzrost<-ggplot(waga1, aes(x=wypadki, y=I(log(avg_temp)) +geom_point(color="blue")
g_wzrost<-ggplot(waga1, aes(x=wypadki, y=log(avg_temp)) +geom_point(color="blue"))
g_wzrost<-ggplot(waga1, aes(x=wypadki, y=I(log(avg_temp)) +geom_point(color="blue"))
g_wiek<-ggplot(waga2, aes(x=Waga, y=Wiek)) +geom_point(color="blue")
g_wzrost<-ggplot(waga1, aes(x=wypadki, y=sum_opady +geom_point(color="blue"))
g_wzrost
g_wzrost<-ggplot(waga1, aes(x=wypadki, y=sum_opady +geom_point(color="blue")
g_wzrost<-ggplot(waga1, aes(x=wypadki, y=sum_opady +geom_point(color="blue")))
g_wzrost
g_wzrost<-ggplot(waga1, aes(x=I(log(wypadki)), y=sum_opady +geom_point(color="blue")))
g_wzrost
g_wzrost<-ggplot(waga1, aes(x=log(wypadki), y=sum_opady +geom_point(color="blue")))
g_wzrost
g_wzrost<-ggplot(waga1, aes(x=wypadki, y=sum_opady +geom_point(color="blue")))
g_wzrost
g_wzrost<-ggplot(waga1, aes(x=wypadki, y=sum_opad)y +geom_point(color="blue")))
g_wzrost
g_wzrost<-ggplot(waga1, aes(x=wypadki, y=sum_opady) +geom_point(color="blue")))
g_wzrost<-ggplot(waga1, aes(x=wypadki, y=sum_opady) +geom_point(color="blue"))
g_wzrost
g_wzrost<-ggplot(waga1, aes(x=wypadki, y=sum_opady)) +geom_point(color="blue"))
g_wzrost
g_wzrost<-ggplot(waga1, aes(x=wypadki, y=sum_opady)) +geom_point(color="blue
g_wzrost
g_wiek<-ggplot(waga2, aes(x=Waga, y=Wiek)) +geom_point(color="blue")
g_wiek
#kolumny z dieta
install.packages("dummies")
library("dummies")
TableofDummies = as.data.frame(dummy(as.factor(waga2$Dieta)))
View(TableofDummies)
colnames(TableofDummies) = c("wsz","fleksi","jarska","wege","wegan")
wege2 = cbind(waga2,TableofDummies  )
View(wege2)
#zmienna lnWAGA
waga2$lnWaga = log(waga2$Waga)
#interakcja
model1=lm(lnWaga~Wiek + Wzrost + Wszystko + Jarska + Wegetarianizm +Wegańska+  Miasto_250 + Miasto_100 + Miasto_20 + Wieś, data=waga2)
summary(model1)
model2=lm(Waga~Wiek + Wzrost + Miasto_250 + Miasto_100 + Miasto_20 +Wieś + Wszystko + Jarska + Wegetarianizm + Wegańska, data=waga2)
summary(model2)
model3=lm(lnWaga~Wiek + Wzrost + Dieta_n + Ćwiczenie + Czy_duzo + Średnie + Student + Podstawowe, data=waga2)
summary(model3)
model4=lm(lnWaga~Wiek + Wzrost + Dieta_n + Ćwiczenie + Czy_duzo + Budowa, data=waga2)
summary(model4)
model5=lm(lnWaga~Wiek + Czy_kobieta+ Wzrost + Dieta_n + Ćwiczenie + Czy_duzo + Budowa, data=waga2)
summary(model5)
model6=lm(lnWaga~Wiek + Czy_kobieta+ Wzrost + Dieta_n + Ćwiczenie + Czy_duzo + Budowa + Zdrowe_jedzenie, data=waga2)
summary(model6)
model7=lm(lnWaga~Wiek + Czy_kobieta+ Wzrost + Dieta_n + Ćwiczenie + Czy_duzo + Budowa + Zdrowe_jedzenie + Tycie_n++  Miasto_250 + Miasto_100 + Miasto_20 + Wieś+ Wszystko + Jarska + Wegetarianizm +Wegańska + Średnie + Student + Podstawowe, data=waga2)
summary(model7)
model8=lm(lnWaga~Wiek + Czy_kobieta+ Wzrost + Dieta_n + Ćwiczenie + Czy_duzo + Budowa + Zdrowe_jedzenie + Tycie_n + Czy_choroba_n+ Wszystko + Jarska + Wegetarianizm +Wegańska, data=waga2)
summary(model8)
model9=lm(lnWaga~Wiek + Czy_kobieta+ Wzrost + Dieta_n + Ćwiczenie + Czy_duzo + Budowa + Zdrowe_jedzenie + Tycie_n + Czy_choroba_n + Czy_ogranicza_m, data=waga2)
summary(model9)
model10=lm(lnWaga~Wiek + Czy_kobieta+ Wzrost + Czy_duzo + Budowa + Tycie_n + Czy_choroba_n,  data=waga2)
summary(model10)
install.packages("stargazer")
library("stargazer")
stargazer(model2, model8,model9, model10, type="text", align= TRUE, style="default", df=FALSE)
stargazer(model2, model8,model9, model10, type="text", align= TRUE, style="default", df=FALSE, star.cutoffs=c(0.05, 0.01,0.001),keep.stat = c(adj.rsq,rsq))
install.packages("car")
library("car")
linearHypothesis(model=model7, c("Wszystko=0","Jarska=0","Wegetarianizm=0","Wegańska=0"))
linearHypothesis(model=model7, c( "Miasto_250=0","Miasto_100=0","Miasto_20=0","Wieś=0"))
linearHypothesis(model=model3, c( "Średnie=0","Student=0","Podstawowe=0"))
linearHypothesis(model=model10, c( "Czy_choroba_n=0"))
summary(model10)$coefficients
plot(model7)
odporna1=coeftest(model10, vcov=vcovHC(model10, type="HC0"))
show(odporna1)
macierz_odporna=vcovHC(model10,type="HC0")
#porownanie oszacowan
stargazer(model10, odporna1, type="text", df=FALSE,
column.labels = c("model10", "white"))
#procedura od ogolu do szczegolu
model7=lm(lnWaga~Wiek + Czy_kobieta+ Wzrost + Ćwiczenie + Czy_duzo
+ Budowa + Zdrowe_jedzenie + Tycie_n+ Miasto_250 + Miasto_100 + Miasto_20
+ Wieś+ Wszystko + Jarska + Wegetarianizm +Wegańska + Średnie + Student + Podstawowe, data=waga2)
summary(model7)
odporna2=coeftest(model7, vcov=vcovHC(model7, type="HC0"))
show(odporna2)
macierz_odporna2=vcovHC(model7,type="HC0")
#czy zmienne nieistotne sa nieistotne
linearHypothesis(model=model7, c("Wszystko=0","Jarska=0","Wegetarianizm=0","Wegańska=0", "Ćwiczenie=0","Zdrowe_jedzenie=0","Miasto_250=0","Miasto_100=0","Miasto_20=0","Wieś=0", "Średnie=0","Student=0","Podstawowe=0"), vcov. = macierz_odporna2)
#najbardziej nieistotna
model7_1=lm(lnWaga~Wiek + Czy_kobieta+ Wzrost + Ćwiczenie + Czy_duzo
+ Budowa + Zdrowe_jedzenie + Tycie_n+ Miasto_250 + Miasto_100 + Miasto_20
+ Wieś+ Jarska + Wegetarianizm +Wegańska + Średnie + Student + Podstawowe, data=waga2)
summary(model7_1)
odporna2_1=coeftest(model7_1, vcov=vcovHC(model7_1, type="HC0"))
show(odporna2_1)
macierz_odporna2_1=vcovHC(model7_1,type="HC0")
#czy zmienne nieistotne sa nieistotne 2
linearHypothesis(model=model7, c("Wszystko=0", "Zdrowe_jedzenie=0"), vcov. = macierz_odporna2)
#0.985
#najbardziej nieistotna 2
model7_2=lm(lnWaga~Wiek + Czy_kobieta+ Wzrost + Ćwiczenie + Czy_duzo
+ Budowa + Tycie_n+ Miasto_250 + Miasto_100 + Miasto_20
+ Wieś+ Jarska + Wegetarianizm +Wegańska + Średnie + Student + Podstawowe, data=waga2)
summary(model7_2)
odporna2_2=coeftest(model7_2, vcov=vcovHC(model7_2, type="HC0"))
show(odporna2_2)
macierz_odporna2_2=vcovHC(model7_2,type="HC0")
#czy zmienne nieistotne sa nieistotne 3
linearHypothesis(model=model7, c("Wszystko=0", "Zdrowe_jedzenie=0", "Miasto_100=0"), vcov. = macierz_odporna2)
#0.9964
#najbardziej nieistotna 3
model7_3=lm(lnWaga~Wiek + Czy_kobieta+ Wzrost + Ćwiczenie + Czy_duzo
+ Budowa + Tycie_n+ Miasto_250 + Miasto_20
+ Wieś+ Jarska + Wegetarianizm +Wegańska + Średnie + Student + Podstawowe, data=waga2)
summary(model7_3)
odporna2_3=coeftest(model7_3, vcov=vcovHC(model7_3, type="HC0"))
show(odporna2_3)
macierz_odporna2_3=vcovHC(model7_3,type="HC0")
#czy zmienne nieistotne sa nieistotne 4
linearHypothesis(model=model7, c("Wszystko=0", "Zdrowe_jedzenie=0", "Miasto_100=0", "Wieś=0"), vcov. = macierz_odporna2)
#0.9974
#najbardziej nieistotna 3
model7_3=lm(lnWaga~Wiek + Czy_kobieta+ Wzrost + Ćwiczenie + Czy_duzo
+ Budowa + Tycie_n+ Miasto_250 + Miasto_20
+ Jarska + Wegetarianizm +Wegańska + Średnie + Student + Podstawowe, data=waga2)
summary(model7_3)
odporna2_3=coeftest(model7_3, vcov=vcovHC(model7_3, type="HC0"))
show(odporna2_3)
macierz_odporna2_3=vcovHC(model7_3,type="HC0")
#czy zmienne nieistotne sa nieistotne 5
linearHypothesis(model=model7, c("Wszystko=0", "Zdrowe_jedzenie=0", "Miasto_100=0", "Wieś=0", "Średnie=0"), vcov. = macierz_odporna2)
#0.9985
#najbardziej nieistotna 4
model7_4=lm(lnWaga~Wiek + Czy_kobieta+ Wzrost + Ćwiczenie + Czy_duzo
+ Budowa + Tycie_n+ Miasto_250 + Miasto_20
+ Jarska + Wegetarianizm +Wegańska +Student + Podstawowe, data=waga2)
summary(model7_4)
odporna2_4=coeftest(model7_4, vcov=vcovHC(model7_4, type="HC0"))
show(odporna2_4)
macierz_odporna2_4=vcovHC(model7_4,type="HC0")
#czy zmienne nieistotne sa nieistotne 5
linearHypothesis(model=model7, c("Wszystko=0", "Zdrowe_jedzenie=0", "Miasto_100=0", "Wieś=0", "Średnie=0", "Wegetarianizm=0"), vcov. = macierz_odporna2)
#0.9956
#najbardziej nieistotna 4
model7_5=lm(lnWaga~Wiek + Czy_kobieta+ Wzrost + Ćwiczenie + Czy_duzo
+ Budowa + Tycie_n+ Miasto_250 + Miasto_20
+ Jarska + Wegańska +Student + Podstawowe, data=waga2)
summary(model7_5)
odporna2_5=coeftest(model7_5, vcov=vcovHC(model7_5, type="HC0"))
show(odporna2_5)
macierz_odporna2_5=vcovHC(model7_5,type="HC0")
#czy zmienne nieistotne sa nieistotne 5
linearHypothesis(model=model7, c("Wszystko=0", "Zdrowe_jedzenie=0", "Miasto_100=0", "Wieś=0", "Średnie=0", "Wegetarianizm=0", "Jarska=0"), vcov. = macierz_odporna2)
#0.9941
#najbardziej nieistotna 4
model7_6=lm(lnWaga~Wiek + Czy_kobieta+ Wzrost + Ćwiczenie + Czy_duzo
+ Budowa + Tycie_n+ Miasto_250 + Miasto_20
+ Wegańska +Student + Podstawowe, data=waga2)
summary(model7_6)
odporna2_6=coeftest(model7_6, vcov=vcovHC(model7_6, type="HC0"))
show(odporna2_6)
macierz_odporna2_6=vcovHC(model7_6,type="HC0")
#czy zmienne nieistotne sa nieistotne 5"
g_wzrost<-ggplot(waga1, aes(x=wypadki, y=sum_opady)) +geom_point(color="blue")
g_wzrost
a
g_wzrost<-ggplot(waga1, aes(x=log(wypadki), y=sum_opady)) +geom_point(color="blue")
g_wzrost
g_wzrost<-ggplot(waga1, aes(x=log(wypadki), y=avg_temp)) +geom_point(color="blue")
g_wzrost
model1=lm(wypadki~avg_temp + sum_opady + avg_wilgotnosc, data=waga2)
model1=lm(wypadki~avg_temp + sum_opady + avg_wilgotnosc, data=waga1)
summary(model1)
